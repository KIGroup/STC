<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="stc/js/services/PersonSrvc.js" application="/csp/dorabotka/" default="1"><![CDATA[
'use strict';
//ddв

/*===========================================================================================
Персоны
===========================================================================================*/

servicesModule.factory('PersonSrvc', function(DALSrvc) {
	return {
        /* Удаление студента из заявки по коду доступа */
        deleteOrderStudent: function(accessCode, studentId){
            return DALSrvc.getPromise('save', StcAppSetting.user + '/json/deleteOrderStudent', {order: {code: accessCode}, student: {id: studentId}});
        },
        /*  */
        deleteSubGroupStudent: function(sgroupId, studentId){
            return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteSubGroupStudent/' + sgroupId + ';' + studentId, null);
        },
        /*  */
        deleteTrainingStudent: function(trainingId, studentId){
            return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteTrainingStudent/' + trainingId + ';' + studentId, null);
        },
        /* Получить студента из заявки по коду доступа*/
        getOrderStudent: function(accessCode, studentId){
            return DALSrvc.getPromise('save', StcAppSetting.user + '/json/getOrderStudent', {order: {code: accessCode}, student: {id: studentId}});
        },
        /* */
        saveOrderStudent: function(accessCode, student){
            return DALSrvc.getPromise('save', StcAppSetting.user + '/json/saveOrderStudent', {order: {code: accessCode}, student: student});
        },
        /* */
        saveOrderStudentAdmin: function(accessCode, student){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/saveOrderStudent', {order: {code: accessCode}, student: student});
        },
        /* */
        getPersonByLastNameOrEmailStartsWith: function(word){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personByLastNameOrEmailStartsWith/' + word, null);
        },
        /* */
        getFreeTeachers: function(courseword){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getFreeTeachers/' + courseword, null);
        },
        getFreeStudents: function(sgroupword){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getFreeStudents/' + sgroupword, null);
        },
        getFreeTrainingStudents: function(trainingword){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getFreeTrainingStudents/' + trainingword, null);
        },
        getPerson: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getPerson/' + id, null);
        },
        getPersonByEmail: function(email){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getPersonByEmail/' + email, null);
        },
        getAllPersons: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/allPersons', obj);
        },
        updatePerson: function(person){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/updatePerson', person);
        },
        createPerson: function(person){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/createPerson', person);
        },
        createCourseTeacher: function(courseId, person){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/createCourseTeacher',  {course: {id: courseId}, teacher: person});
        },
        deleteCourseTeacher: function(courseId, teacherId){
            return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteCourseTeacher/' + courseId + ';' + teacherId,  null);
        },
        createSubGroupStudent: function(trainingId, groupId, person){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/createSubGroupStudent', {training: {id: trainingId},group: {id: groupId}, student: person});
        },
        getCourseTeachers: function(courseId){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getCourseTeachers/' + courseId, null);
        },
        changeCompanyContact: function(data){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/changeCompanyContact', data);
        },

        getPersonOrders: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personOrders/' + id, null);
        },
        getPersonTrainings: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personTrainings/' + id, null);
        },
        getPersonCourses: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personCourses/' + id, null);
        },
        getPersonCompanies: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personCompanies/' + id, null);
        },
        getPersonCertificates: function(id){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/personCertificates/' + id, null);
        },
        deletePerson: function(id){
	   		return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deletePerson/' + id, null);
	    }
       
    }
});
  
]]></CSP>
</Export>
