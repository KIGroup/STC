<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="stc/js/services/TrainingSrvc.js" application="/csp/feb/" default="1"><![CDATA[
'use strict';
//dddddde

/*===========================================================================================
Обучения
===========================================================================================*/

servicesModule.factory('TrainingSrvc', function(DALSrvc) {
	return {
        /* Добавить слушателя из заявки в обучение */
        addNewStudentIntoTraining: function(trainingData){
           return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/addNewStudentIntoTraining', trainingData);
        },
        /* Сохранить/ создать обучение */
        saveTraining: function(trainingData){
           return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/saveTraining', trainingData);
        },
        /* Удалить обучение */
        deleteTraining: function(id){
           return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteTraining/'+id, null);
        },
        /* Завершить обучение */
        completeTraining: function(trainingId){
           return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/completeTraining', {id: trainingId});
        },
        /* Создать подгруппы из заявок для существующего обучения */
        createSubGroupsForTraining: function(trainingData){
           return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/createSubGroupsForTraining', trainingData);
        },
        /* Получить обучение */
        getTraining: function(id){
           return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/getTraining/' + id, null);
        },
        /* Получить обучение для пользователя*/
        getTrainingForUser: function(id){
           return DALSrvc.getPromise('get', StcAppSetting.user + '/json/training/' + id, null);
        },
        /* Все сертификаты обучения */
        getCertificates: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, trainingId){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       trainingId: trainingId};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/training/getCertificates', obj);
        },
        createCertificates: function(trainingId){
	        return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/training/createCertificates', {id: trainingId});
	    },
        /* Получить все обучения для таблицы */
        getTrainings: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, status){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       status: status};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/allTrainings', obj);
        },
        /* Все подгруппы обучения для таблицы */
        getTrainingSubGroups: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, trainingId){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       trainingId: trainingId};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/getTrainingSubGroups', obj);
        },
        /* Все слушатели обучения для таблицы */
        getTrainingStudents: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, trainingId){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       trainingId: trainingId};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/getTrainingStudents', obj);
        },
        /* Все слушатели обучения для таблицы */
        getTrainingStudentsByAccessCode: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, code){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       accessCode: code};

            return DALSrvc.getPromise('save', StcAppSetting.user + '/json/trainingStudents', obj);
        },
        /* Все валюты */
        getCurrencies: function(){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/allCurrencies', null);
        },
        /* Сохранить платеж */
        saveSubGroupPayment: function(payment){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/saveSubGroupPayment', payment);  
        },
        /* Сохранить инфу о договоре */
        saveSubGroupContract: function(contract){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/saveSubGroupContract', contract);  
        },
        /* Создать подгруппу и добавить ее в обучение */
        createSubGroup: function(sgData){
            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/createSubGroup', sgData);  
        },
        /* Удалить подгруппу из обучения */
        deleteSubGroup: function(trainingId, sgroupId){
            return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteSubGroup/' + trainingId + ';' + sgroupId, null);  
        },
        doEvent: function(data){
	        return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/trainingEvent', data);
	      },
        getEmailContacts: function(trainingId){
          	return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/trainingStudentsEmails/' + trainingId, null);
        },
        sendEmail: function(data){
          	return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/training/sendEmail', data);
        },
        changeStatusAutoMailing: function(data){
          	return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/changeTrainingStatusAutoMailing', data);
        },
        saveFeedBack: function(data){
            return DALSrvc.getPromise('save', StcAppSetting.user + '/json/saveFeedBack', data);
        },
        /* All training feedbacks */
        getFeedBacks: function(pageCurr, pageSize, sqlName, isDown, searchSqlName, searchText, trainingId){
            var first = pageSize * (pageCurr - 1) + 1;
            var obj = {sqlName: sqlName, 
                       isDown: isDown, 
                       first: first, 
                       last: first + pageSize - 1,
                       searchSqlName: searchSqlName, 
                       searchText: searchText,
                       trainingId: trainingId};

            return DALSrvc.getPromise('save', StcAppSetting.admin + '/json/getFeedBacks', obj);
        },
        deleteFeedBack: function(id){
            return DALSrvc.getPromise('delete', StcAppSetting.admin + '/json/deleteFeedBack/' + id, null); 
        },
        getMailPattern: function(type){
            return DALSrvc.getPromise('get', StcAppSetting.admin + '/json/mailPattern/' + type, null);
        }
    }
});
  
]]></CSP>
</Export>
